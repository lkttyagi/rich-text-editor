{"ast":null,"code":"import _classCallCheck from \"/home/webiee/paper-editor/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/webiee/paper-editor/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/webiee/paper-editor/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/webiee/paper-editor/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/webiee/paper-editor/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/webiee/paper-editor/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/webiee/paper-editor/src/components/Editor.js\";\nimport React, { Component } from 'react';\nimport { Editor, getEventRange, getEventTransfer } from 'slate-react';\nimport { Block, Value } from 'slate';\nimport initialValue from './_value';\nimport sampleValue from './_sample';\ndocument.title = 'Slate Editor Project';\nvar storedValue = JSON.parse(localStorage.getItem('content'));\nvar value = Value.fromJSON(storedValue || initialValue);\nvar DEFAULT_NODE = 'paragraph';\nvar schema = {\n  document: {\n    last: {\n      type: 'paragraph'\n    },\n    normalize: function normalize(editor, _ref) {\n      var code = _ref.code,\n          node = _ref.node,\n          child = _ref.child;\n\n      switch (code) {\n        case 'last_child_type_invalid':\n          {\n            var paragraph = Block.create('paragraph');\n            return editor.insertNodeByKey(node.key, node.nodes.size, paragraph);\n          }\n      }\n    }\n  },\n  blocks: {\n    image: {\n      isVoid: true\n    }\n  }\n};\n\nfunction insertImage(editor, src, target) {\n  if (target) {\n    editor.select(target);\n  }\n\n  editor.insertBlock({\n    type: 'image',\n    data: {\n      src: src\n    }\n  });\n}\n\nfunction MarkHotkeys(options) {\n  var key = options.key,\n      type = options.type;\n  return {\n    onKeyDown: function onKeyDown(event, editor, next) {\n      if (!event.ctrlKey || event.key !== key) return next();\n      event.preventDefault();\n      editor.toggleMark(type);\n    }\n  };\n}\n\nvar plugins = [MarkHotkeys({\n  key: 'b',\n  type: 'bold'\n}), MarkHotkeys({\n  key: 'i',\n  type: 'italic'\n}), MarkHotkeys({\n  key: 'u',\n  type: 'underline'\n}), MarkHotkeys({\n  key: '-',\n  type: 'strikethrough'\n}), MarkHotkeys({\n  key: '`',\n  type: 'code'\n})];\n/**\n * Main app component file\n */\n\nvar MyEditor =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(MyEditor, _Component);\n\n  function MyEditor() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, MyEditor);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(MyEditor)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      value: value,\n      nodeLimit: 0,\n      saveDisabled: false\n    };\n\n    _this.onChange = function (_ref2) {\n      var value = _ref2.value;\n\n      _this.setState({\n        value: value\n      });\n\n      var blockSize = _this.editor.value.document.getBlocks().size;\n\n      var nodeLimit = _this.state.nodeLimit;\n      var saveDisabled;\n\n      if (nodeLimit !== 0 && blockSize > nodeLimit) {\n        saveDisabled = true;\n      } else {\n        saveDisabled = false;\n      }\n\n      _this.setState({\n        saveDisabled: saveDisabled\n      });\n    };\n\n    _this.ref = function (editor) {\n      return _this.editor = editor;\n    };\n\n    _this.hasBlock = function (type) {\n      var value = _this.state.value;\n      return value.blocks.some(function (node) {\n        return node.type === type;\n      });\n    };\n\n    _this.renderMarkButton = function (type, name) {\n      return React.createElement(\"button\", {\n        onMouseDown: function onMouseDown(event) {\n          return _this.activateMark(event, type);\n        },\n        title: type,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 94\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        class: \"fas \".concat(name),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      }));\n    };\n\n    _this.renderBlockButton = function (type, name) {\n      var isActive = _this.hasBlock(type);\n\n      if (type === 'numbered-list' || type === 'bulleted-list') {\n        var _value = _this.state.value;\n\n        if (_value.blocks.size > 0) {\n          var parent = _value.document.getParent(_value.blocks.first().key);\n\n          isActive = _this.hasBlock('list-item') && parent && parent.type === type;\n        }\n      }\n\n      if (type === 'imageBrowser') {\n        return React.createElement(\"div\", {\n          className: \"upload-btn-wrapper\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 115\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          title: type,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 116\n          },\n          __self: this\n        }, React.createElement(\"input\", {\n          type: \"file\",\n          id: \"input-button\",\n          onChange: function onChange(event) {\n            return _this.activateBlock(event, type);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        }), React.createElement(\"i\", {\n          class: \"fas \".concat(name),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        })));\n      }\n\n      return React.createElement(\"button\", {\n        title: type,\n        onClick: function onClick(event) {\n          return _this.activateBlock(event, type);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(\"i\", {\n        class: \"fas \".concat(name),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }));\n    };\n\n    _this.activateMark = function (event, type) {\n      event.preventDefault();\n\n      _this.editor.toggleMark(type);\n    };\n\n    _this.activateBlock = function (event, type) {\n      event.preventDefault();\n\n      var _assertThisInitialize = _assertThisInitialized(_assertThisInitialized(_this)),\n          editor = _assertThisInitialize.editor;\n\n      var value = editor.value;\n      var document = value.document;\n\n      if (type === 'image') {\n        // Show URl prompt\n        var src = prompt('Please enter an image url: ');\n        if (!src) return;\n        editor.command(insertImage, src);\n      }\n\n      if (type === 'imageBrowser') {\n        var getBase64 = function getBase64(file) {\n          return new Promise(function (resolve, reject) {\n            var reader = new FileReader();\n            var allowedTypes = ['image/jpeg', 'image/jpg', 'image/png', 'image/gif'];\n\n            if (!allowedTypes.includes(file.type)) {\n              window.alert('Only jpg, png & gif image files are allowed!');\n              return;\n            }\n\n            reader.readAsDataURL(file);\n\n            reader.onload = function () {\n              return resolve(reader.result);\n            };\n\n            reader.onerror = function (error) {\n              return reject(error);\n            };\n          });\n        };\n\n        getBase64(event.currentTarget.files[0]).then(function (imageData) {\n          editor.command(insertImage, imageData);\n        });\n      } // Handle everything but list buttons.\n\n\n      if (type !== 'bulleted-list' && type !== 'numbered-list') {\n        var isActive = _this.hasBlock(type);\n\n        var isList = _this.hasBlock('list-item');\n\n        if (isList) {\n          editor.setBlocks(isActive ? DEFAULT_NODE : type).unwrapBlock('bulleted-list').unwrapBlock('numbered-list');\n        } else {\n          editor.setBlocks(isActive ? DEFAULT_NODE : type);\n        }\n      } else {\n        // Handle the extra wrapping required for list buttons.\n        var _isList = _this.hasBlock('list-item');\n\n        var isType = value.blocks.some(function (block) {\n          return !!document.getClosest(block.key, function (parent) {\n            return parent.type === type;\n          });\n        });\n\n        if (_isList && isType) {\n          editor.setBlocks(DEFAULT_NODE).unwrapBlock('bulleted-list').unwrapBlock('numbered-list');\n        } else if (_isList) {\n          editor.unwrapBlock(type === 'bulleted-list' ? 'numbered-list' : 'bulleted-list').wrapBlock(type);\n        } else {\n          editor.setBlocks('list-item').wrapBlock(type);\n        }\n      }\n    };\n\n    _this.renderMark = function (props, editor, next) {\n      var mark = props.mark,\n          attributes = props.attributes,\n          children = props.children;\n\n      switch (mark.type) {\n        case 'bold':\n          return React.createElement(\"strong\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 220\n            },\n            __self: this\n          }), children);\n\n        case 'italic':\n          return React.createElement(\"em\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 222\n            },\n            __self: this\n          }), children);\n\n        case 'underline':\n          return React.createElement(\"u\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 224\n            },\n            __self: this\n          }), children);\n\n        case 'code':\n          return React.createElement(\"code\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 226\n            },\n            __self: this\n          }), children);\n\n        case 'strikethrough':\n          return React.createElement(\"del\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 228\n            },\n            __self: this\n          }), children);\n\n        default:\n          return next();\n      }\n    };\n\n    _this.renderNode = function (props, editor, next) {\n      var node = props.node,\n          attributes = props.attributes,\n          children = props.children;\n\n      switch (node.type) {\n        case 'heading-one':\n          return React.createElement(\"h1\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 239\n            },\n            __self: this\n          }), children);\n\n        case 'heading-two':\n          return React.createElement(\"h2\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 241\n            },\n            __self: this\n          }), children);\n\n        case 'paragraph':\n          return React.createElement(\"p\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 243\n            },\n            __self: this\n          }), children);\n\n        case 'blockquote':\n          return React.createElement(\"blockquote\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 245\n            },\n            __self: this\n          }), children);\n\n        case 'bulleted-list':\n          return React.createElement(\"ul\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 247\n            },\n            __self: this\n          }), children);\n\n        case 'numbered-list':\n          return React.createElement(\"ol\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 249\n            },\n            __self: this\n          }), children);\n\n        case 'list-item':\n          return React.createElement(\"li\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 251\n            },\n            __self: this\n          }), children);\n\n        case 'code':\n          return React.createElement(\"pre\", Object.assign({}, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 254\n            },\n            __self: this\n          }), React.createElement(\"code\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 255\n            },\n            __self: this\n          }, children));\n\n        case 'image':\n          var src = node.data.get('src');\n          return React.createElement(\"img\", Object.assign({\n            src: src\n          }, attributes, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 260\n            },\n            __self: this\n          }));\n\n        default:\n          return next();\n      }\n    };\n\n    _this.onKeyDown = function (event, editor, next) {\n      // Do nothing if it's not a list item.\n      var isList = _this.hasBlock('list-item');\n\n      if (!isList) {\n        return next();\n      }\n\n      var value = editor.value;\n      var document = value.document;\n      var block = value.blocks.first();\n      var parent = block ? document.getParent(block.key) : null;\n\n      if (!event.shiftKey && event.key === 'Tab') {\n        event.preventDefault();\n        var type = !parent.type ? 'bulleted-list' : parent.type; // check whether it's already in 3rd level\n\n        var depth = document.getDepth(block.key);\n\n        if (depth > 3) {\n          event.preventDefault();\n          return next();\n        }\n\n        if (parent) {\n          editor.setBlocks('list-item').wrapBlock(type);\n        }\n      }\n\n      if (event.shiftKey && event.key == 'Tab') {\n        event.preventDefault(); // if multi level list items are selected for shift+tab, then return\n\n        var firstBlockDepth = block && document.getDepth(block.key);\n        var multiLevelSelected = false;\n        value.blocks.map(function (currentKey) {\n          var currentDepth = document.getDepth(currentKey.key);\n          multiLevelSelected = !!(firstBlockDepth !== currentDepth);\n          return true;\n        });\n        if (multiLevelSelected) return next(); // if first level list-items selected then, make paragraph\n\n        if (parent && typeof parent.type === 'undefined') {\n          editor.setBlocks(DEFAULT_NODE).unwrapBlock('bulleted-list').unwrapBlock('numbered-list');\n          return next();\n        }\n\n        var _depth = document.getDepth(block.key);\n\n        var isActive = _this.hasBlock('list-item') && block && (parent.type === 'numbered-list' || parent.type === 'bulleted-list');\n\n        var onlyList = _this.hasBlock('list-item');\n\n        if (isActive) {\n          editor.setBlocks('list-item').unwrapBlock('bulleted-list').unwrapBlock('numbered-list');\n        } else if (isActive && _depth <= 2) {\n          editor.setBlocks(DEFAULT_NODE).unwrapBlock('bulleted-list').unwrapBlock('numbered-list');\n        } else {\n          editor.setBlocks(DEFAULT_NODE).unwrapBlock('bulleted-list').unwrapBlock('numbered-list');\n        } // Making sure we don't have an orphan list item\n\n\n        if (onlyList && _depth <= 2) {\n          editor.setBlocks(DEFAULT_NODE).unwrapBlock('list-item').unwrapBlock('bulleted-list').unwrapBlock('numbered-list');\n        }\n      }\n\n      return next();\n    };\n\n    _this.loadSampleContent = function () {\n      var value = Value.fromJSON(sampleValue);\n\n      _this.setState({\n        value: value\n      });\n    };\n\n    _this.saveContent = function () {\n      var content = JSON.stringify(_this.state.value.toJSON());\n      localStorage.setItem('content', content);\n      alert('Saved to browser.');\n    };\n\n    _this.restoreContent = function () {\n      var storedValue = JSON.parse(localStorage.getItem('content'));\n      var value = Value.fromJSON(storedValue || initialValue);\n\n      _this.setState({\n        value: value\n      });\n    };\n\n    _this.updateNodeLimit = function (event) {\n      event.preventDefault();\n      var nodeLimit = parseInt(event.target.limit.value, 10);\n\n      var blockSize = _this.editor.value.document.getBlocks().size;\n\n      var saveDisabled;\n\n      if (nodeLimit !== 0 && blockSize > nodeLimit) {\n        saveDisabled = true;\n      } else {\n        saveDisabled = false;\n      }\n\n      _this.setState({\n        nodeLimit: nodeLimit,\n        saveDisabled: saveDisabled\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(MyEditor, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        id: \"shell\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 392\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 393\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 394\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"title-area\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 395\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        id: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 396\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 397\n        },\n        __self: this\n      }, \"Text Editor\")), React.createElement(\"div\", {\n        id: \"menu\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 400\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"buttons\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 401\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        id: \"toolbar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 407\n        },\n        __self: this\n      }, this.renderMarkButton('bold', 'fa-bold'), this.renderMarkButton('italic', 'fa-italic'), this.renderMarkButton('underline', 'fa-underline'), this.renderMarkButton('strikethrough', 'fa-strikethrough'), this.renderMarkButton('code', 'fa-code'), this.renderBlockButton('heading-one', 'fa-heading'), this.renderBlockButton('heading-two', 'fa-heading'), this.renderBlockButton('paragraph', 'fa-paragraph'), this.renderBlockButton('code', 'fa-terminal'), this.renderBlockButton('blockquote', 'fa-quote-right'), this.renderBlockButton('numbered-list', 'fa-list-ol'), this.renderBlockButton('bulleted-list', 'fa-list-ul'), this.renderBlockButton('image', 'fa-image'), this.renderBlockButton('imageBrowser', 'fa-cloud-upload-alt')))), React.createElement(\"div\", {\n        id: \"paper\",\n        className: \"wrapper\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 425\n        },\n        __self: this\n      }, React.createElement(Editor, {\n        ref: this.ref,\n        autoFocus: true,\n        spellCheck: false,\n        placeholder: \"Start writing..\",\n        value: this.state.value,\n        onChange: this.onChange,\n        onKeyDown: this.onKeyDown,\n        renderMark: this.renderMark,\n        renderNode: this.renderNode,\n        plugins: plugins,\n        schema: schema,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 426\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return MyEditor;\n}(Component);\n\nexport { MyEditor as default };","map":{"version":3,"sources":["/home/webiee/paper-editor/src/components/Editor.js"],"names":["React","Component","Editor","getEventRange","getEventTransfer","Block","Value","initialValue","sampleValue","document","title","storedValue","JSON","parse","localStorage","getItem","value","fromJSON","DEFAULT_NODE","schema","last","type","normalize","editor","code","node","child","paragraph","create","insertNodeByKey","key","nodes","size","blocks","image","isVoid","insertImage","src","target","select","insertBlock","data","MarkHotkeys","options","onKeyDown","event","next","ctrlKey","preventDefault","toggleMark","plugins","MyEditor","state","nodeLimit","saveDisabled","onChange","setState","blockSize","getBlocks","ref","hasBlock","some","renderMarkButton","name","activateMark","renderBlockButton","isActive","parent","getParent","first","activateBlock","prompt","command","getBase64","file","Promise","resolve","reject","reader","FileReader","allowedTypes","includes","window","alert","readAsDataURL","onload","result","onerror","error","currentTarget","files","then","imageData","isList","setBlocks","unwrapBlock","isType","block","getClosest","wrapBlock","renderMark","props","mark","attributes","children","renderNode","get","shiftKey","depth","getDepth","firstBlockDepth","multiLevelSelected","map","currentKey","currentDepth","onlyList","loadSampleContent","saveContent","content","stringify","toJSON","setItem","restoreContent","updateNodeLimit","parseInt","limit"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,MAAT,EAAiBC,aAAjB,EAAgCC,gBAAhC,QAAwD,aAAxD;AACA,SAASC,KAAT,EAAgBC,KAAhB,QAA6B,OAA7B;AACA,OAAOC,YAAP,MAAyB,UAAzB;AACA,OAAOC,WAAP,MAAwB,WAAxB;AAEAC,QAAQ,CAACC,KAAT,GAAiB,sBAAjB;AAEA,IAAMC,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAX,CAApB;AACA,IAAMC,KAAK,GAAGV,KAAK,CAACW,QAAN,CAAeN,WAAW,IAAIJ,YAA9B,CAAd;AACA,IAAMW,YAAY,GAAG,WAArB;AACA,IAAMC,MAAM,GAAG;AACbV,EAAAA,QAAQ,EAAE;AACRW,IAAAA,IAAI,EAAE;AAAEC,MAAAA,IAAI,EAAE;AAAR,KADE;AAERC,IAAAA,SAAS,EAAE,mBAACC,MAAD,QAAmC;AAAA,UAAxBC,IAAwB,QAAxBA,IAAwB;AAAA,UAAlBC,IAAkB,QAAlBA,IAAkB;AAAA,UAAZC,KAAY,QAAZA,KAAY;;AAC5C,cAAQF,IAAR;AACE,aAAK,yBAAL;AAAgC;AAC9B,gBAAMG,SAAS,GAAGtB,KAAK,CAACuB,MAAN,CAAa,WAAb,CAAlB;AACA,mBAAOL,MAAM,CAACM,eAAP,CAAuBJ,IAAI,CAACK,GAA5B,EAAiCL,IAAI,CAACM,KAAL,CAAWC,IAA5C,EAAkDL,SAAlD,CAAP;AACD;AAJH;AAMD;AATO,GADG;AAYbM,EAAAA,MAAM,EAAE;AACNC,IAAAA,KAAK,EAAE;AACLC,MAAAA,MAAM,EAAE;AADH;AADD;AAZK,CAAf;;AAmBA,SAASC,WAAT,CAAqBb,MAArB,EAA6Bc,GAA7B,EAAkCC,MAAlC,EAA0C;AACxC,MAAIA,MAAJ,EAAY;AACVf,IAAAA,MAAM,CAACgB,MAAP,CAAcD,MAAd;AACD;;AAEDf,EAAAA,MAAM,CAACiB,WAAP,CAAmB;AACjBnB,IAAAA,IAAI,EAAE,OADW;AAEjBoB,IAAAA,IAAI,EAAE;AAAEJ,MAAAA,GAAG,EAAHA;AAAF;AAFW,GAAnB;AAID;;AAED,SAASK,WAAT,CAAqBC,OAArB,EAA8B;AAAA,MACtBb,GADsB,GACRa,OADQ,CACtBb,GADsB;AAAA,MACjBT,IADiB,GACRsB,OADQ,CACjBtB,IADiB;AAE5B,SAAO;AACLuB,IAAAA,SADK,qBACKC,KADL,EACYtB,MADZ,EACoBuB,IADpB,EAC0B;AAC7B,UAAI,CAACD,KAAK,CAACE,OAAP,IAAkBF,KAAK,CAACf,GAAN,KAAcA,GAApC,EAAyC,OAAOgB,IAAI,EAAX;AACzCD,MAAAA,KAAK,CAACG,cAAN;AACAzB,MAAAA,MAAM,CAAC0B,UAAP,CAAkB5B,IAAlB;AACD;AALI,GAAP;AAOD;;AAED,IAAM6B,OAAO,GAAG,CACdR,WAAW,CAAC;AAAEZ,EAAAA,GAAG,EAAE,GAAP;AAAYT,EAAAA,IAAI,EAAE;AAAlB,CAAD,CADG,EAEdqB,WAAW,CAAC;AAAEZ,EAAAA,GAAG,EAAE,GAAP;AAAYT,EAAAA,IAAI,EAAE;AAAlB,CAAD,CAFG,EAGdqB,WAAW,CAAC;AAAEZ,EAAAA,GAAG,EAAE,GAAP;AAAYT,EAAAA,IAAI,EAAE;AAAlB,CAAD,CAHG,EAIdqB,WAAW,CAAC;AAAEZ,EAAAA,GAAG,EAAE,GAAP;AAAYT,EAAAA,IAAI,EAAE;AAAlB,CAAD,CAJG,EAKdqB,WAAW,CAAC;AAAEZ,EAAAA,GAAG,EAAE,GAAP;AAAYT,EAAAA,IAAI,EAAE;AAAlB,CAAD,CALG,CAAhB;AAQA;;;;IAGqB8B,Q;;;;;;;;;;;;;;;;;UACnBC,K,GAAQ;AACNpC,MAAAA,KAAK,EAAEA,KADD;AAENqC,MAAAA,SAAS,EAAE,CAFL;AAGNC,MAAAA,YAAY,EAAE;AAHR,K;;UAMRC,Q,GAAW,iBAAe;AAAA,UAAZvC,KAAY,SAAZA,KAAY;;AACxB,YAAKwC,QAAL,CAAc;AAAExC,QAAAA,KAAK,EAALA;AAAF,OAAd;;AACA,UAAIyC,SAAS,GAAG,MAAKlC,MAAL,CAAYP,KAAZ,CAAkBP,QAAlB,CAA2BiD,SAA3B,GAAuC1B,IAAvD;;AAFwB,UAGlBqB,SAHkB,GAGJ,MAAKD,KAHD,CAGlBC,SAHkB;AAIxB,UAAIC,YAAJ;;AACA,UAAID,SAAS,KAAK,CAAd,IAAmBI,SAAS,GAAGJ,SAAnC,EAA8C;AAC5CC,QAAAA,YAAY,GAAG,IAAf;AACD,OAFD,MAEO;AACLA,QAAAA,YAAY,GAAG,KAAf;AACD;;AAED,YAAKE,QAAL,CAAc;AAAEF,QAAAA,YAAY,EAAZA;AAAF,OAAd;AACD,K;;UAEDK,G,GAAM,UAACpC,MAAD;AAAA,aAAa,MAAKA,MAAL,GAAcA,MAA3B;AAAA,K;;UAENqC,Q,GAAW,UAACvC,IAAD,EAAU;AAAA,UACbL,KADa,GACH,MAAKoC,KADF,CACbpC,KADa;AAEnB,aAAOA,KAAK,CAACiB,MAAN,CAAa4B,IAAb,CAAkB,UAACpC,IAAD;AAAA,eAAUA,IAAI,CAACJ,IAAL,KAAcA,IAAxB;AAAA,OAAlB,CAAP;AACD,K;;UAEDyC,gB,GAAmB,UAACzC,IAAD,EAAO0C,IAAP,EAAgB;AACjC,aACE;AACE,QAAA,WAAW,EAAE,qBAAClB,KAAD;AAAA,iBAAW,MAAKmB,YAAL,CAAkBnB,KAAlB,EAAyBxB,IAAzB,CAAX;AAAA,SADf;AAEE,QAAA,KAAK,EAAEA,IAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAGE;AAAG,QAAA,KAAK,gBAAS0C,IAAT,CAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAHF,CADF;AAOD,K;;UAEDE,iB,GAAoB,UAAC5C,IAAD,EAAO0C,IAAP,EAAgB;AAClC,UAAIG,QAAQ,GAAG,MAAKN,QAAL,CAAcvC,IAAd,CAAf;;AAEA,UAAIA,IAAI,KAAK,eAAT,IAA4BA,IAAI,KAAK,eAAzC,EAA0D;AAAA,YAClDL,MADkD,GACxC,MAAKoC,KADmC,CAClDpC,KADkD;;AAExD,YAAIA,MAAK,CAACiB,MAAN,CAAaD,IAAb,GAAoB,CAAxB,EAA2B;AACzB,cAAImC,MAAM,GAAGnD,MAAK,CAACP,QAAN,CAAe2D,SAAf,CAAyBpD,MAAK,CAACiB,MAAN,CAAaoC,KAAb,GAAqBvC,GAA9C,CAAb;;AACAoC,UAAAA,QAAQ,GAAG,MAAKN,QAAL,CAAc,WAAd,KAA8BO,MAA9B,IAAwCA,MAAM,CAAC9C,IAAP,KAAgBA,IAAnE;AACD;AACF;;AAED,UAAIA,IAAI,KAAK,cAAb,EAA6B;AAC3B,eACE;AAAK,UAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AAAQ,UAAA,KAAK,EAAEA,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,EAAE,EAAC,cAFL;AAGE,UAAA,QAAQ,EAAE,kBAACwB,KAAD;AAAA,mBAAW,MAAKyB,aAAL,CAAmBzB,KAAnB,EAA0BxB,IAA1B,CAAX;AAAA,WAHZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,EAME;AAAG,UAAA,KAAK,gBAAS0C,IAAT,CAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UANF,CADF,CADF;AAYD;;AAED,aACE;AAAQ,QAAA,KAAK,EAAE1C,IAAf;AAAqB,QAAA,OAAO,EAAE,iBAACwB,KAAD;AAAA,iBAAW,MAAKyB,aAAL,CAAmBzB,KAAnB,EAA0BxB,IAA1B,CAAX;AAAA,SAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAG,QAAA,KAAK,gBAAS0C,IAAT,CAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CADF;AAKD,K;;UAEDC,Y,GAAe,UAACnB,KAAD,EAAQxB,IAAR,EAAiB;AAC9BwB,MAAAA,KAAK,CAACG,cAAN;;AACA,YAAKzB,MAAL,CAAY0B,UAAZ,CAAuB5B,IAAvB;AACD,K;;UAEDiD,a,GAAgB,UAACzB,KAAD,EAAQxB,IAAR,EAAiB;AAC/BwB,MAAAA,KAAK,CAACG,cAAN;;AAD+B;AAAA,UAGvBzB,MAHuB,yBAGvBA,MAHuB;;AAAA,UAIvBP,KAJuB,GAIbO,MAJa,CAIvBP,KAJuB;AAAA,UAKvBP,QALuB,GAKVO,KALU,CAKvBP,QALuB;;AAO/B,UAAIY,IAAI,KAAK,OAAb,EAAsB;AACpB;AACA,YAAIgB,GAAG,GAAGkC,MAAM,CAAC,6BAAD,CAAhB;AACA,YAAI,CAAClC,GAAL,EAAU;AACVd,QAAAA,MAAM,CAACiD,OAAP,CAAepC,WAAf,EAA4BC,GAA5B;AACD;;AAED,UAAIhB,IAAI,KAAK,cAAb,EAA6B;AAC3B,YAAMoD,SAAS,GAAG,SAAZA,SAAY,CAACC,IAAD;AAAA,iBAChB,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC/B,gBAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;AACA,gBAAMC,YAAY,GAAG,CACnB,YADmB,EAEnB,WAFmB,EAGnB,WAHmB,EAInB,WAJmB,CAArB;;AAMA,gBAAI,CAACA,YAAY,CAACC,QAAb,CAAsBP,IAAI,CAACrD,IAA3B,CAAL,EAAuC;AACrC6D,cAAAA,MAAM,CAACC,KAAP,CAAa,8CAAb;AACA;AACD;;AACDL,YAAAA,MAAM,CAACM,aAAP,CAAqBV,IAArB;;AACAI,YAAAA,MAAM,CAACO,MAAP,GAAgB;AAAA,qBAAMT,OAAO,CAACE,MAAM,CAACQ,MAAR,CAAb;AAAA,aAAhB;;AACAR,YAAAA,MAAM,CAACS,OAAP,GAAiB,UAACC,KAAD;AAAA,qBAAWX,MAAM,CAACW,KAAD,CAAjB;AAAA,aAAjB;AACD,WAfD,CADgB;AAAA,SAAlB;;AAiBAf,QAAAA,SAAS,CAAC5B,KAAK,CAAC4C,aAAN,CAAoBC,KAApB,CAA0B,CAA1B,CAAD,CAAT,CAAwCC,IAAxC,CAA6C,UAACC,SAAD,EAAe;AAC1DrE,UAAAA,MAAM,CAACiD,OAAP,CAAepC,WAAf,EAA4BwD,SAA5B;AACD,SAFD;AAGD,OAnC8B,CAqC/B;;;AACA,UAAIvE,IAAI,KAAK,eAAT,IAA4BA,IAAI,KAAK,eAAzC,EAA0D;AACxD,YAAM6C,QAAQ,GAAG,MAAKN,QAAL,CAAcvC,IAAd,CAAjB;;AACA,YAAMwE,MAAM,GAAG,MAAKjC,QAAL,CAAc,WAAd,CAAf;;AAEA,YAAIiC,MAAJ,EAAY;AACVtE,UAAAA,MAAM,CACHuE,SADH,CACa5B,QAAQ,GAAGhD,YAAH,GAAkBG,IADvC,EAEG0E,WAFH,CAEe,eAFf,EAGGA,WAHH,CAGe,eAHf;AAID,SALD,MAKO;AACLxE,UAAAA,MAAM,CAACuE,SAAP,CAAiB5B,QAAQ,GAAGhD,YAAH,GAAkBG,IAA3C;AACD;AACF,OAZD,MAYO;AACL;AACA,YAAMwE,OAAM,GAAG,MAAKjC,QAAL,CAAc,WAAd,CAAf;;AACA,YAAMoC,MAAM,GAAGhF,KAAK,CAACiB,MAAN,CAAa4B,IAAb,CACb,UAACoC,KAAD;AAAA,iBACE,CAAC,CAACxF,QAAQ,CAACyF,UAAT,CAAoBD,KAAK,CAACnE,GAA1B,EAA+B,UAACqC,MAAD;AAAA,mBAAYA,MAAM,CAAC9C,IAAP,KAAgBA,IAA5B;AAAA,WAA/B,CADJ;AAAA,SADa,CAAf;;AAKA,YAAIwE,OAAM,IAAIG,MAAd,EAAsB;AACpBzE,UAAAA,MAAM,CACHuE,SADH,CACa5E,YADb,EAEG6E,WAFH,CAEe,eAFf,EAGGA,WAHH,CAGe,eAHf;AAID,SALD,MAKO,IAAIF,OAAJ,EAAY;AACjBtE,UAAAA,MAAM,CACHwE,WADH,CAEI1E,IAAI,KAAK,eAAT,GAA2B,eAA3B,GAA6C,eAFjD,EAIG8E,SAJH,CAIa9E,IAJb;AAKD,SANM,MAMA;AACLE,UAAAA,MAAM,CAACuE,SAAP,CAAiB,WAAjB,EAA8BK,SAA9B,CAAwC9E,IAAxC;AACD;AACF;AACF,K;;UAGD+E,U,GAAa,UAACC,KAAD,EAAQ9E,MAAR,EAAgBuB,IAAhB,EAAyB;AAAA,UAC9BwD,IAD8B,GACCD,KADD,CAC9BC,IAD8B;AAAA,UACxBC,UADwB,GACCF,KADD,CACxBE,UADwB;AAAA,UACZC,QADY,GACCH,KADD,CACZG,QADY;;AAEpC,cAAQF,IAAI,CAACjF,IAAb;AACE,aAAK,MAAL;AACE,iBAAO,gDAAYkF,UAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAyBC,QAAzB,CAAP;;AACF,aAAK,QAAL;AACE,iBAAO,4CAAQD,UAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAqBC,QAArB,CAAP;;AACF,aAAK,WAAL;AACE,iBAAO,2CAAOD,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAoBC,QAApB,CAAP;;AACF,aAAK,MAAL;AACE,iBAAO,8CAAUD,UAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAuBC,QAAvB,CAAP;;AACF,aAAK,eAAL;AACE,iBAAO,6CAASD,UAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAsBC,QAAtB,CAAP;;AACF;AACE,iBAAO1D,IAAI,EAAX;AAZJ;AAcD,K;;UAGD2D,U,GAAa,UAACJ,KAAD,EAAQ9E,MAAR,EAAgBuB,IAAhB,EAAyB;AAAA,UAC9BrB,IAD8B,GACC4E,KADD,CAC9B5E,IAD8B;AAAA,UACxB8E,UADwB,GACCF,KADD,CACxBE,UADwB;AAAA,UACZC,QADY,GACCH,KADD,CACZG,QADY;;AAEpC,cAAQ/E,IAAI,CAACJ,IAAb;AACE,aAAK,aAAL;AACE,iBAAO,4CAAQkF,UAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAqBC,QAArB,CAAP;;AACF,aAAK,aAAL;AACE,iBAAO,4CAAQD,UAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAqBC,QAArB,CAAP;;AACF,aAAK,WAAL;AACE,iBAAO,2CAAOD,UAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAoBC,QAApB,CAAP;;AACF,aAAK,YAAL;AACE,iBAAO,oDAAgBD,UAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAA6BC,QAA7B,CAAP;;AACF,aAAK,eAAL;AACE,iBAAO,4CAAQD,UAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAqBC,QAArB,CAAP;;AACF,aAAK,eAAL;AACE,iBAAO,4CAAQD,UAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAqBC,QAArB,CAAP;;AACF,aAAK,WAAL;AACE,iBAAO,4CAAQD,UAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAAqBC,QAArB,CAAP;;AACF,aAAK,MAAL;AACE,iBACE,6CAASD,UAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAOC,QAAP,CADF,CADF;;AAKF,aAAK,OAAL;AACE,cAAInE,GAAG,GAAGZ,IAAI,CAACgB,IAAL,CAAUiE,GAAV,CAAc,KAAd,CAAV;AACA,iBAAO;AAAK,YAAA,GAAG,EAAErE;AAAV,aAAmBkE,UAAnB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAAP;;AAEF;AACE,iBAAOzD,IAAI,EAAX;AA1BJ;AA4BD,K;;UAEDF,S,GAAY,UAACC,KAAD,EAAQtB,MAAR,EAAgBuB,IAAhB,EAAyB;AACnC;AACA,UAAI+C,MAAM,GAAG,MAAKjC,QAAL,CAAc,WAAd,CAAb;;AAEA,UAAI,CAACiC,MAAL,EAAa;AACX,eAAO/C,IAAI,EAAX;AACD;;AANkC,UAQ3B9B,KAR2B,GAQjBO,MARiB,CAQ3BP,KAR2B;AAAA,UAS3BP,QAT2B,GASdO,KATc,CAS3BP,QAT2B;AAWnC,UAAMwF,KAAK,GAAGjF,KAAK,CAACiB,MAAN,CAAaoC,KAAb,EAAd;AACA,UAAMF,MAAM,GAAG8B,KAAK,GAAGxF,QAAQ,CAAC2D,SAAT,CAAmB6B,KAAK,CAACnE,GAAzB,CAAH,GAAmC,IAAvD;;AAEA,UAAI,CAACe,KAAK,CAAC8D,QAAP,IAAmB9D,KAAK,CAACf,GAAN,KAAc,KAArC,EAA4C;AAC1Ce,QAAAA,KAAK,CAACG,cAAN;AAEA,YAAM3B,IAAI,GAAG,CAAC8C,MAAM,CAAC9C,IAAR,GAAe,eAAf,GAAiC8C,MAAM,CAAC9C,IAArD,CAH0C,CAK1C;;AACA,YAAMuF,KAAK,GAAGnG,QAAQ,CAACoG,QAAT,CAAkBZ,KAAK,CAACnE,GAAxB,CAAd;;AACA,YAAI8E,KAAK,GAAG,CAAZ,EAAe;AACb/D,UAAAA,KAAK,CAACG,cAAN;AACA,iBAAOF,IAAI,EAAX;AACD;;AAED,YAAIqB,MAAJ,EAAY;AACV5C,UAAAA,MAAM,CAACuE,SAAP,CAAiB,WAAjB,EAA8BK,SAA9B,CAAwC9E,IAAxC;AACD;AACF;;AAED,UAAIwB,KAAK,CAAC8D,QAAN,IAAkB9D,KAAK,CAACf,GAAN,IAAa,KAAnC,EAA0C;AACxCe,QAAAA,KAAK,CAACG,cAAN,GADwC,CAGxC;;AACA,YAAM8D,eAAe,GAAGb,KAAK,IAAIxF,QAAQ,CAACoG,QAAT,CAAkBZ,KAAK,CAACnE,GAAxB,CAAjC;AACA,YAAIiF,kBAAkB,GAAG,KAAzB;AACA/F,QAAAA,KAAK,CAACiB,MAAN,CAAa+E,GAAb,CAAiB,UAACC,UAAD,EAAgB;AAC/B,cAAMC,YAAY,GAAGzG,QAAQ,CAACoG,QAAT,CAAkBI,UAAU,CAACnF,GAA7B,CAArB;AACAiF,UAAAA,kBAAkB,GAAG,CAAC,EAAED,eAAe,KAAKI,YAAtB,CAAtB;AACA,iBAAO,IAAP;AACD,SAJD;AAKA,YAAIH,kBAAJ,EAAwB,OAAOjE,IAAI,EAAX,CAXgB,CAaxC;;AACA,YAAIqB,MAAM,IAAI,OAAOA,MAAM,CAAC9C,IAAd,KAAuB,WAArC,EAAkD;AAChDE,UAAAA,MAAM,CACHuE,SADH,CACa5E,YADb,EAEG6E,WAFH,CAEe,eAFf,EAGGA,WAHH,CAGe,eAHf;AAIA,iBAAOjD,IAAI,EAAX;AACD;;AACD,YAAM8D,MAAK,GAAGnG,QAAQ,CAACoG,QAAT,CAAkBZ,KAAK,CAACnE,GAAxB,CAAd;;AAEA,YAAMoC,QAAQ,GACZ,MAAKN,QAAL,CAAc,WAAd,KACAqC,KADA,KAEC9B,MAAM,CAAC9C,IAAP,KAAgB,eAAhB,IAAmC8C,MAAM,CAAC9C,IAAP,KAAgB,eAFpD,CADF;;AAKA,YAAM8F,QAAQ,GAAG,MAAKvD,QAAL,CAAc,WAAd,CAAjB;;AAEA,YAAIM,QAAJ,EAAc;AACZ3C,UAAAA,MAAM,CACHuE,SADH,CACa,WADb,EAEGC,WAFH,CAEe,eAFf,EAGGA,WAHH,CAGe,eAHf;AAID,SALD,MAKO,IAAI7B,QAAQ,IAAI0C,MAAK,IAAI,CAAzB,EAA4B;AACjCrF,UAAAA,MAAM,CACHuE,SADH,CACa5E,YADb,EAEG6E,WAFH,CAEe,eAFf,EAGGA,WAHH,CAGe,eAHf;AAID,SALM,MAKA;AACLxE,UAAAA,MAAM,CACHuE,SADH,CACa5E,YADb,EAEG6E,WAFH,CAEe,eAFf,EAGGA,WAHH,CAGe,eAHf;AAID,SA7CuC,CA8CxC;;;AACA,YAAIoB,QAAQ,IAAIP,MAAK,IAAI,CAAzB,EAA4B;AAC1BrF,UAAAA,MAAM,CACHuE,SADH,CACa5E,YADb,EAEG6E,WAFH,CAEe,WAFf,EAGGA,WAHH,CAGe,eAHf,EAIGA,WAJH,CAIe,eAJf;AAKD;AACF;;AAED,aAAOjD,IAAI,EAAX;AACD,K;;UAGDsE,iB,GAAoB,YAAM;AACxB,UAAIpG,KAAK,GAAGV,KAAK,CAACW,QAAN,CAAeT,WAAf,CAAZ;;AACA,YAAKgD,QAAL,CAAc;AAAExC,QAAAA,KAAK,EAALA;AAAF,OAAd;AACD,K;;UAGDqG,W,GAAc,YAAM;AAClB,UAAIC,OAAO,GAAG1G,IAAI,CAAC2G,SAAL,CAAe,MAAKnE,KAAL,CAAWpC,KAAX,CAAiBwG,MAAjB,EAAf,CAAd;AACA1G,MAAAA,YAAY,CAAC2G,OAAb,CAAqB,SAArB,EAAgCH,OAAhC;AACAnC,MAAAA,KAAK,CAAC,mBAAD,CAAL;AACD,K;;UAGDuC,c,GAAiB,YAAM;AACrB,UAAM/G,WAAW,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,SAArB,CAAX,CAApB;AACA,UAAIC,KAAK,GAAGV,KAAK,CAACW,QAAN,CAAeN,WAAW,IAAIJ,YAA9B,CAAZ;;AACA,YAAKiD,QAAL,CAAc;AAAExC,QAAAA,KAAK,EAALA;AAAF,OAAd;AACD,K;;UAED2G,e,GAAkB,UAAC9E,KAAD,EAAW;AAC3BA,MAAAA,KAAK,CAACG,cAAN;AACA,UAAIK,SAAS,GAAGuE,QAAQ,CAAC/E,KAAK,CAACP,MAAN,CAAauF,KAAb,CAAmB7G,KAApB,EAA2B,EAA3B,CAAxB;;AACA,UAAIyC,SAAS,GAAG,MAAKlC,MAAL,CAAYP,KAAZ,CAAkBP,QAAlB,CAA2BiD,SAA3B,GAAuC1B,IAAvD;;AACA,UAAIsB,YAAJ;;AACA,UAAID,SAAS,KAAK,CAAd,IAAmBI,SAAS,GAAGJ,SAAnC,EAA8C;AAC5CC,QAAAA,YAAY,GAAG,IAAf;AACD,OAFD,MAEO;AACLA,QAAAA,YAAY,GAAG,KAAf;AACD;;AACD,YAAKE,QAAL,CAAc;AAAEH,QAAAA,SAAS,EAATA,SAAF;AAAaC,QAAAA,YAAY,EAAZA;AAAb,OAAd;AACD,K;;;;;;;6BAEQ;AACP,aACE;AAAK,QAAA,EAAE,EAAC,OAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,EAAE,EAAC,QAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,EAAE,EAAC,YAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,EAAE,EAAC,OAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADF,CADF,EAKE;AAAK,QAAA,EAAE,EAAC,MAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CALF,CADF,EAaE;AAAK,QAAA,EAAE,EAAC,SAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACG,KAAKQ,gBAAL,CAAsB,MAAtB,EAA8B,SAA9B,CADH,EAEG,KAAKA,gBAAL,CAAsB,QAAtB,EAAgC,WAAhC,CAFH,EAGG,KAAKA,gBAAL,CAAsB,WAAtB,EAAmC,cAAnC,CAHH,EAIG,KAAKA,gBAAL,CAAsB,eAAtB,EAAuC,kBAAvC,CAJH,EAKG,KAAKA,gBAAL,CAAsB,MAAtB,EAA8B,SAA9B,CALH,EAMG,KAAKG,iBAAL,CAAuB,aAAvB,EAAsC,YAAtC,CANH,EAOG,KAAKA,iBAAL,CAAuB,aAAvB,EAAsC,YAAtC,CAPH,EAQG,KAAKA,iBAAL,CAAuB,WAAvB,EAAoC,cAApC,CARH,EASG,KAAKA,iBAAL,CAAuB,MAAvB,EAA+B,aAA/B,CATH,EAUG,KAAKA,iBAAL,CAAuB,YAAvB,EAAqC,gBAArC,CAVH,EAWG,KAAKA,iBAAL,CAAuB,eAAvB,EAAwC,YAAxC,CAXH,EAYG,KAAKA,iBAAL,CAAuB,eAAvB,EAAwC,YAAxC,CAZH,EAaG,KAAKA,iBAAL,CAAuB,OAAvB,EAAgC,UAAhC,CAbH,EAcG,KAAKA,iBAAL,CAAuB,cAAvB,EAAuC,qBAAvC,CAdH,CAbF,CADF,CADF,EAiCE;AAAK,QAAA,EAAE,EAAC,OAAR;AAAgB,QAAA,SAAS,EAAC,SAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE,oBAAC,MAAD;AACE,QAAA,GAAG,EAAE,KAAKN,GADZ;AAEE,QAAA,SAAS,MAFX;AAGE,QAAA,UAAU,EAAE,KAHd;AAIE,QAAA,WAAW,EAAC,iBAJd;AAKE,QAAA,KAAK,EAAE,KAAKP,KAAL,CAAWpC,KALpB;AAME,QAAA,QAAQ,EAAE,KAAKuC,QANjB;AAOE,QAAA,SAAS,EAAE,KAAKX,SAPlB;AAQE,QAAA,UAAU,EAAE,KAAKwD,UARnB;AASE,QAAA,UAAU,EAAE,KAAKK,UATnB;AAUE,QAAA,OAAO,EAAEvD,OAVX;AAWE,QAAA,MAAM,EAAE/B,MAXV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADF,CAjCF,CADF;AAmDD;;;;EA1XmClB,S;;SAAjBkD,Q","sourcesContent":["import React, { Component } from 'react';\nimport { Editor, getEventRange, getEventTransfer } from 'slate-react';\nimport { Block, Value } from 'slate';\nimport initialValue from './_value';\nimport sampleValue from './_sample';\n\ndocument.title = 'Slate Editor Project';\n\nconst storedValue = JSON.parse(localStorage.getItem('content'));\nconst value = Value.fromJSON(storedValue || initialValue);\nconst DEFAULT_NODE = 'paragraph';\nconst schema = {\n  document: {\n    last: { type: 'paragraph' },\n    normalize: (editor, { code, node, child }) => {\n      switch (code) {\n        case 'last_child_type_invalid': {\n          const paragraph = Block.create('paragraph');\n          return editor.insertNodeByKey(node.key, node.nodes.size, paragraph);\n        }\n      }\n    }\n  },\n  blocks: {\n    image: {\n      isVoid: true\n    }\n  }\n};\n\nfunction insertImage(editor, src, target) {\n  if (target) {\n    editor.select(target);\n  }\n\n  editor.insertBlock({\n    type: 'image',\n    data: { src }\n  });\n}\n\nfunction MarkHotkeys(options) {\n  let { key, type } = options;\n  return {\n    onKeyDown(event, editor, next) {\n      if (!event.ctrlKey || event.key !== key) return next();\n      event.preventDefault();\n      editor.toggleMark(type);\n    }\n  };\n}\n\nconst plugins = [\n  MarkHotkeys({ key: 'b', type: 'bold' }),\n  MarkHotkeys({ key: 'i', type: 'italic' }),\n  MarkHotkeys({ key: 'u', type: 'underline' }),\n  MarkHotkeys({ key: '-', type: 'strikethrough' }),\n  MarkHotkeys({ key: '`', type: 'code' })\n];\n\n/**\n * Main app component file\n */\nexport default class MyEditor extends Component {\n  state = {\n    value: value,\n    nodeLimit: 0,\n    saveDisabled: false\n  };\n\n  onChange = ({ value }) => {\n    this.setState({ value });\n    let blockSize = this.editor.value.document.getBlocks().size;\n    let { nodeLimit } = this.state;\n    let saveDisabled;\n    if (nodeLimit !== 0 && blockSize > nodeLimit) {\n      saveDisabled = true;\n    } else {\n      saveDisabled = false;\n    }\n\n    this.setState({ saveDisabled });\n  };\n\n  ref = (editor) => (this.editor = editor);\n\n  hasBlock = (type) => {\n    let { value } = this.state;\n    return value.blocks.some((node) => node.type === type);\n  };\n\n  renderMarkButton = (type, name) => {\n    return (\n      <button\n        onMouseDown={(event) => this.activateMark(event, type)}\n        title={type}>\n        <i class={`fas ${name}`} />\n      </button>\n    );\n  };\n\n  renderBlockButton = (type, name) => {\n    let isActive = this.hasBlock(type);\n\n    if (type === 'numbered-list' || type === 'bulleted-list') {\n      let { value } = this.state;\n      if (value.blocks.size > 0) {\n        let parent = value.document.getParent(value.blocks.first().key);\n        isActive = this.hasBlock('list-item') && parent && parent.type === type;\n      }\n    }\n\n    if (type === 'imageBrowser') {\n      return (\n        <div className=\"upload-btn-wrapper\">\n          <button title={type}>\n            <input\n              type=\"file\"\n              id=\"input-button\"\n              onChange={(event) => this.activateBlock(event, type)}\n            />\n            <i class={`fas ${name}`} />\n          </button>\n        </div>\n      );\n    }\n\n    return (\n      <button title={type} onClick={(event) => this.activateBlock(event, type)}>\n        <i class={`fas ${name}`} />\n      </button>\n    );\n  };\n\n  activateMark = (event, type) => {\n    event.preventDefault();\n    this.editor.toggleMark(type);\n  };\n\n  activateBlock = (event, type) => {\n    event.preventDefault();\n\n    const { editor } = this;\n    const { value } = editor;\n    const { document } = value;\n\n    if (type === 'image') {\n      // Show URl prompt\n      let src = prompt('Please enter an image url: ');\n      if (!src) return;\n      editor.command(insertImage, src);\n    }\n\n    if (type === 'imageBrowser') {\n      const getBase64 = (file) =>\n        new Promise((resolve, reject) => {\n          const reader = new FileReader();\n          const allowedTypes = [\n            'image/jpeg',\n            'image/jpg',\n            'image/png',\n            'image/gif'\n          ];\n          if (!allowedTypes.includes(file.type)) {\n            window.alert('Only jpg, png & gif image files are allowed!');\n            return;\n          }\n          reader.readAsDataURL(file);\n          reader.onload = () => resolve(reader.result);\n          reader.onerror = (error) => reject(error);\n        });\n      getBase64(event.currentTarget.files[0]).then((imageData) => {\n        editor.command(insertImage, imageData);\n      });\n    }\n\n    // Handle everything but list buttons.\n    if (type !== 'bulleted-list' && type !== 'numbered-list') {\n      const isActive = this.hasBlock(type);\n      const isList = this.hasBlock('list-item');\n\n      if (isList) {\n        editor\n          .setBlocks(isActive ? DEFAULT_NODE : type)\n          .unwrapBlock('bulleted-list')\n          .unwrapBlock('numbered-list');\n      } else {\n        editor.setBlocks(isActive ? DEFAULT_NODE : type);\n      }\n    } else {\n      // Handle the extra wrapping required for list buttons.\n      const isList = this.hasBlock('list-item');\n      const isType = value.blocks.some(\n        (block) =>\n          !!document.getClosest(block.key, (parent) => parent.type === type)\n      );\n\n      if (isList && isType) {\n        editor\n          .setBlocks(DEFAULT_NODE)\n          .unwrapBlock('bulleted-list')\n          .unwrapBlock('numbered-list');\n      } else if (isList) {\n        editor\n          .unwrapBlock(\n            type === 'bulleted-list' ? 'numbered-list' : 'bulleted-list'\n          )\n          .wrapBlock(type);\n      } else {\n        editor.setBlocks('list-item').wrapBlock(type);\n      }\n    }\n  };\n\n  // Render Mark Function\n  renderMark = (props, editor, next) => {\n    let { mark, attributes, children } = props;\n    switch (mark.type) {\n      case 'bold':\n        return <strong {...attributes}>{children}</strong>;\n      case 'italic':\n        return <em {...attributes}>{children}</em>;\n      case 'underline':\n        return <u {...attributes}>{children}</u>;\n      case 'code':\n        return <code {...attributes}>{children}</code>;\n      case 'strikethrough':\n        return <del {...attributes}>{children}</del>;\n      default:\n        return next();\n    }\n  };\n\n  // Render Node Function\n  renderNode = (props, editor, next) => {\n    let { node, attributes, children } = props;\n    switch (node.type) {\n      case 'heading-one':\n        return <h1 {...attributes}>{children}</h1>;\n      case 'heading-two':\n        return <h2 {...attributes}>{children}</h2>;\n      case 'paragraph':\n        return <p {...attributes}>{children}</p>;\n      case 'blockquote':\n        return <blockquote {...attributes}>{children}</blockquote>;\n      case 'bulleted-list':\n        return <ul {...attributes}>{children}</ul>;\n      case 'numbered-list':\n        return <ol {...attributes}>{children}</ol>;\n      case 'list-item':\n        return <li {...attributes}>{children}</li>;\n      case 'code':\n        return (\n          <pre {...attributes}>\n            <code>{children}</code>\n          </pre>\n        );\n      case 'image':\n        let src = node.data.get('src');\n        return <img src={src} {...attributes} />;\n\n      default:\n        return next();\n    }\n  };\n\n  onKeyDown = (event, editor, next) => {\n    // Do nothing if it's not a list item.\n    let isList = this.hasBlock('list-item');\n\n    if (!isList) {\n      return next();\n    }\n\n    const { value } = editor;\n    const { document } = value;\n\n    const block = value.blocks.first();\n    const parent = block ? document.getParent(block.key) : null;\n\n    if (!event.shiftKey && event.key === 'Tab') {\n      event.preventDefault();\n\n      const type = !parent.type ? 'bulleted-list' : parent.type;\n\n      // check whether it's already in 3rd level\n      const depth = document.getDepth(block.key);\n      if (depth > 3) {\n        event.preventDefault();\n        return next();\n      }\n\n      if (parent) {\n        editor.setBlocks('list-item').wrapBlock(type);\n      }\n    }\n\n    if (event.shiftKey && event.key == 'Tab') {\n      event.preventDefault();\n\n      // if multi level list items are selected for shift+tab, then return\n      const firstBlockDepth = block && document.getDepth(block.key);\n      let multiLevelSelected = false;\n      value.blocks.map((currentKey) => {\n        const currentDepth = document.getDepth(currentKey.key);\n        multiLevelSelected = !!(firstBlockDepth !== currentDepth);\n        return true;\n      });\n      if (multiLevelSelected) return next();\n\n      // if first level list-items selected then, make paragraph\n      if (parent && typeof parent.type === 'undefined') {\n        editor\n          .setBlocks(DEFAULT_NODE)\n          .unwrapBlock('bulleted-list')\n          .unwrapBlock('numbered-list');\n        return next();\n      }\n      const depth = document.getDepth(block.key);\n\n      const isActive =\n        this.hasBlock('list-item') &&\n        block &&\n        (parent.type === 'numbered-list' || parent.type === 'bulleted-list');\n\n      const onlyList = this.hasBlock('list-item');\n\n      if (isActive) {\n        editor\n          .setBlocks('list-item')\n          .unwrapBlock('bulleted-list')\n          .unwrapBlock('numbered-list');\n      } else if (isActive && depth <= 2) {\n        editor\n          .setBlocks(DEFAULT_NODE)\n          .unwrapBlock('bulleted-list')\n          .unwrapBlock('numbered-list');\n      } else {\n        editor\n          .setBlocks(DEFAULT_NODE)\n          .unwrapBlock('bulleted-list')\n          .unwrapBlock('numbered-list');\n      }\n      // Making sure we don't have an orphan list item\n      if (onlyList && depth <= 2) {\n        editor\n          .setBlocks(DEFAULT_NODE)\n          .unwrapBlock('list-item')\n          .unwrapBlock('bulleted-list')\n          .unwrapBlock('numbered-list');\n      }\n    }\n\n    return next();\n  };\n\n  // Load Sample content\n  loadSampleContent = () => {\n    let value = Value.fromJSON(sampleValue);\n    this.setState({ value });\n  };\n\n  // Save content\n  saveContent = () => {\n    let content = JSON.stringify(this.state.value.toJSON());\n    localStorage.setItem('content', content);\n    alert('Saved to browser.');\n  };\n\n  // Restore content\n  restoreContent = () => {\n    const storedValue = JSON.parse(localStorage.getItem('content'));\n    let value = Value.fromJSON(storedValue || initialValue);\n    this.setState({ value });\n  };\n\n  updateNodeLimit = (event) => {\n    event.preventDefault();\n    let nodeLimit = parseInt(event.target.limit.value, 10);\n    let blockSize = this.editor.value.document.getBlocks().size;\n    let saveDisabled;\n    if (nodeLimit !== 0 && blockSize > nodeLimit) {\n      saveDisabled = true;\n    } else {\n      saveDisabled = false;\n    }\n    this.setState({ nodeLimit, saveDisabled });\n  };\n\n  render() {\n    return (\n      <div id=\"shell\">\n        <div id=\"header\">\n          <div className=\"wrapper\">\n            <div id=\"title-area\">\n              <div id=\"title\">\n                <h2>Text Editor</h2>\n              </div>\n              \n              <div id=\"menu\">\n                <div className=\"buttons\">\n                  \n                  \n                </div>\n              </div>\n            </div>\n            <div id=\"toolbar\">\n              {this.renderMarkButton('bold', 'fa-bold')}\n              {this.renderMarkButton('italic', 'fa-italic')}\n              {this.renderMarkButton('underline', 'fa-underline')}\n              {this.renderMarkButton('strikethrough', 'fa-strikethrough')}\n              {this.renderMarkButton('code', 'fa-code')}\n              {this.renderBlockButton('heading-one', 'fa-heading')}\n              {this.renderBlockButton('heading-two', 'fa-heading')}\n              {this.renderBlockButton('paragraph', 'fa-paragraph')}\n              {this.renderBlockButton('code', 'fa-terminal')}\n              {this.renderBlockButton('blockquote', 'fa-quote-right')}\n              {this.renderBlockButton('numbered-list', 'fa-list-ol')}\n              {this.renderBlockButton('bulleted-list', 'fa-list-ul')}\n              {this.renderBlockButton('image', 'fa-image')}\n              {this.renderBlockButton('imageBrowser', 'fa-cloud-upload-alt')}\n            </div>\n          </div>\n        </div>\n        <div id=\"paper\" className=\"wrapper\">\n          <Editor\n            ref={this.ref}\n            autoFocus\n            spellCheck={false}\n            placeholder=\"Start writing..\"\n            value={this.state.value}\n            onChange={this.onChange}\n            onKeyDown={this.onKeyDown}\n            renderMark={this.renderMark}\n            renderNode={this.renderNode}\n            plugins={plugins}\n            schema={schema}\n          />\n        </div>\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}